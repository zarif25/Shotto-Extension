$(document).ready(function(){chrome.storage.sync.get(["isOn"],function(e){if(e.isOn){const e=["untangled","daily star","nutshell","cablgram","business standard"];function t(e,t){let r=function(e){return mapped_text=[...e].filter(e=>!" .,!?;%()[]{}+-/\\'\"=><".includes(e)).map(e=>e>="A"&&e<="z"),trues=mapped_text.filter(e=>e).length,trues/mapped_text.length>.5}(t)?"en":"bn";return text_words=function(e,t){return sentence_list=e.split(/[\.!?;।(\r\n|\r|\n)]/).map(e=>e.replace(/[\\\/,;%(){}[\]'”“"=><*:]/g,"")).map(e=>e.replace(/\s{2}/g," ")).map(e=>e.replace(/….+/,"")).map(e=>e.trim()).filter(e=>" "!=e&&e).map(e=>e.split(" ")),words=[],sentence_list.forEach(e=>words.push(...e)),words=words.filter(e=>"#"!=e[0]),words}(t),matchNos=[],"en"==r?e.en.forEach(e=>{let t=text_words.filter(t=>e.words.includes(t)).length;matchNos.push(t)}):e.bn.forEach(e=>{let t=text_words.filter(t=>e.words.includes(t)).length;matchNos.push(t)}),maxVal=Math.max(...matchNos),isVerified=text_words.length<=5?maxVal/text_words.length>1:maxVal/text_words.length>.2,[r,matchNos.indexOf(maxVal),isVerified]}function r(r){feeds=function(){try{return feeds=[],document.querySelectorAll('[role="feed"]').forEach(e=>feeds.push(...e.children)),feeds}catch(e){return[]}}(),feedsInfo=feeds.map(e=>(function(e){try{return h4=e.querySelector("h4"),{userH:h4,post:e,user:h4.innerText,verified:null!=e.querySelector('div[aria-label*="Verified"]'),checked:null!=h4.querySelector("h1"),text:e.querySelector('div[data-ad-comet-preview="message"]').innerText}}catch(t){try{return h2=e.querySelector("h2"),{userH:h2,post:e,user:h2.innerText,verified:null!=e.querySelector('div[aria-label*="Verified"]'),checked:null!=h2.querySelector("h1"),text:e.querySelector('div[data-ad-comet-preview="message"]').innerText}}catch(t){return e}}})(e)),feedsInfo.forEach(n=>{if(n.user&&!n.checked){let s=document.createElement("h1"),l=document.createElement("div");if(l.style.borderRadius="5px",l.style.padding="5px",l.style.background="#191919",l.style.display="none",n.verified||e.some(e=>n.user.toLowerCase().includes(e)))s.innerText="Trusted Source",s.style.color="#00EBAC",l.innerHTML="\n                <p style='color:#00EBAC;margin:0'>Authenticity Score: 100%<br/>Bias Category: Neutral</p>\n                ",s.style.cursor="pointer",s.addEventListener("click",function(){"none"==l.style.display?l.style.display="block":l.style.display="none"});else if(n.text){let[e,i,o]=t(r,n.text);o?(s.innerText="Verified",s.style.color="#00EBAC",s.style.cursor="pointer",l.innerHTML="<p style='color:#00EBAC;margin:0'>Authenticity Score: 93%</p>",links=r[e][i].related||[],links.length>0&&(l.innerHTML+="<h1 style='color:#efefef'>Related artices:</h1>"),links.forEach(e=>{l.innerHTML+=`<a style="#4e9ecb" href='${e}'>${e}</a><br/>`}),s.addEventListener("click",function(){"none"==l.style.display?l.style.display="block":l.style.display="none"})):(s.innerText="Not Verified",s.style.color="#ffbc04")}else s.innerText="Not Verified",s.style.color="#ffbc04";n.userH.appendChild(s),n.userH.appendChild(l)}})}fetch("https://storage.googleapis.com/shotto/static/newslist.json",{mode:"cors"}).then(e=>e.json()).then(e=>{r(e),document.addEventListener("scroll",function(t){r(e)})})}})});
